{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no">
    {% block title %}

    {% endblock title %}
    <link rel="icon" type="image/x-icon" href="{% static 'assets/img/favicon.ico' %}"/>
    <link href="{% static 'assets/css/loader.css' %}" rel="stylesheet" type="text/css"/>
    <script src="{% static 'assets/js/loader.js' %}"></script>

    <!-- BEGIN GLOBAL MANDATORY STYLES -->
    <link href="https://fonts.googleapis.com/css?family=Nunito:400,600,700" rel="stylesheet">
    <link href="{% static 'bootstrap/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'assets/css/plugins.css' %}" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    {% block css %}

    {% endblock css %}
</head>

<style>
.video-tutorial-container {
    position: fixed;
    top: 70px;
    right: 20px;
    z-index: 9999;
    background: white;
    padding: 8px 12px;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
}

.video-tutorial-link {
    color: #4361ee;
    text-decoration: none;
    display: flex;
    align-items: center;
}

.video-tutorial-link:hover {
    text-decoration: underline;
}

.video-tutorial-link i {
    margin-right: 5px;
}

.video-tutorial-edit-btn {
    margin-left: 8px;
    padding: 2px 6px;
}
</style>
<style>
/* Chrome, Safari, Edge */
input[type=number]::-webkit-outer-spin-button,
input[type=number]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

/* Firefox */
input[type=number] {
    -moz-appearance: textfield;
}
</style>
<body class="sidebar-noneoverflow">
<!-- BEGIN LOADER -->
<div id="load_screen">
    <div class="loader">
        <div class="loader-content">
            <div class="spinner-grow align-self-center"></div>
        </div>
    </div>
</div>
<!--  END LOADER -->

<!--  BEGIN NAVBAR  -->
<div class="header-container fixed-top">
    <header class="header navbar navbar-expand-sm">
        <a href="javascript:void(0);" class="sidebarCollapse" data-placement="bottom">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-menu">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </a>
        <!-- <div id="message_container">
            {% for message in messages %}
                {% if message.tags == "success" %}
                    <h5 class="text-success" style="margin: 0 2rem;">{{ message }}</h5>
                {% elif message.tags == "error" %}
                    <h5 class="text-danger" style="margin: 0 2rem;">{{ message }}</h5>
                {% elif message.tags == "info" %}
                    <h5 class="text-info" style="margin: 0 2rem;">{{ message }}</h5>
                {% elif message.tags == "warning" %}
                    <h5 class="text-warning" style="margin: 0 2rem;">{{ message }}</h5>
                {% else %}
                    <h5 class="text-secondary" style="margin: 0 2rem;">{{ message }}</h5>  {# fallback uchun #}
                {% endif %}
            {% endfor %}
        </div> -->




        <ul class="navbar-item flex-row navbar-dropdown" style="  display: flex;flex-wrap: wrap;justify-content: flex-start;margin-bottom: 10px;gap: 50px; width: 100%;overflow-x: auto;white-space: nowrap;">
            
        </ul>
        <div class="" style="margin: 0.5rem;">
        </div>

    
    </header>
    <!-- <div class="">
        <div class="video-tutorial-container" style="display: none;">
            <a href="#" class="video-tutorial-link" target="_blank">
                <i class="fas fa-video"></i> Video qo'llanma
            </a>
        </div>
        {% if user.is_superuser %}
        <button class="video-tutorial-edit-btn btn btn-sm btn-primary ml-2">
            Qo'llanma <i class="fas fa-edit"></i>
        </button>
        {% endif %}
    </div> -->
</div>
<div class="main-container" id="container">

    <div class="overlay"></div>
    <div class="cs-overlay"></div>
    <div class="search-overlay"></div>

    <!--  BEGIN SIDEBAR  -->
    <div class="sidebar-wrapper sidebar-theme">
        {% if request.user.userprofile.staff == 4 %}
        <nav id="sidebar">
            <div class="shadow-bottom"></div>
            <ul class="list-unstyled menu-categories" id="accordionExample">
                <li class="menu {{desktop_kassa}}">
                    <a href="{% url 'omborqabul' %}" aria-expanded="{{desktop_kassa_true}}" class="dropdown-toggle">
                        <div class="feather feather-layers">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                 fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                 stroke-linejoin="round" class="">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            <span>Ombor Qabul </span>
                        </div>
                    </a>
                </li>

                <li class="menu {{reieve}}">
                    <a href="{% url 'recieve' %}" aria-expanded="true" class="dropdown-toggle">
                        <div class="feather feather-layers">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                 fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                 stroke-linejoin="round" class="">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            <span>Qabul</span>
                        </div>
                    </a>
                </li>
                
                <li class="menu ">
                    <a href="{% url 'logout' %}" aria-expanded="false" class="dropdown-toggle">
                        <div class="">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                 fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                 stroke-linejoin="round" class="feather feather-log-out">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                            <span>Chiqish</span>
                        </div>
                    </a>
                </li>

            </ul>

        </nav>
        {% else %}
        <nav id="sidebar">

            <div class="shadow-bottom"></div>
                <ul class="list-unstyled menu-categories" id="accordionExample">
                    <li class="menu {% if request.resolver_match.url_name == 'home' or request.resolver_match.url_name == 'filial' %}active{% endif %}">
                        <a href="#components12" data-toggle="collapse" aria-expanded="{% if request.resolver_match.url_name == 'home' or request.resolver_match.url_name == 'filial' %}true{% endif %}" class="dropdown-toggle">
                            <div class="">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="feather feather-home">
                                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                                </svg>
                                <span>Dashboard</span>
                            </div>
                            <div>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="feather feather-chevron-right">
                                    <polyline points="9 18 15 12 9 6"></polyline>
                                </svg>
                            </div>
                        </a>
                        
                        <ul class="collapse submenu list-unstyled {% if request.resolver_match.url_name == 'home' or request.resolver_match.url_name == 'filial'  %}show{% endif %}"
                            id="components12" data-parent="#accordionExample">
                            {% if custom_user_profile.is_bussines %} 
                            <li class="menu {% if request.resolver_match.url_name == 'home' %}active{% endif %}">
                                <a href="{% url 'home' %}">Bussines Tahlili</a>
                            </li>
                            {% endif %}

                            {% if custom_user_profile.is_filial_boshkaruvi %} 
                                <li class="menu {% if request.resolver_match.url_name == 'filial' %}active{% endif %}">
                                    <a href="{% url 'filial' %}"> Filiallar Boshqaruvi </a>
                                </li>
                            {% endif %}
                        </ul>
                    </li>
                    {% with url_name=request.resolver_match.url_name %}
                        <li class="menu {% if url_name in 'mobile_order_list mobile_order_detail todays_practices today_sales shops b2b_shop b2b_shop_ajax b2c_shop b2c_shop_detail' %}active{% endif %}">
                            <a href="#narx-sotuvlar" data-toggle="collapse" aria-expanded="{% if url_name in 'mobile_order_list mobile_order_detail todays_practices today_sales b2c_shop b2c_shop_detail shops b2b_shop b2b_shop_ajax'  %}true{% endif %}" class="dropdown-toggle">
                                <div style="display: flex; align-items: center;">
                                    <i class="fa-solid fa-cart-shopping" style="font-size: 17px;"></i>
                                    <span style="margin-left: 10px;">Sotuvlar</span>
                                </div>
                                <div>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round" class="feather feather-chevron-right">
                                        <polyline points="9 18 15 12 9 6"></polyline>
                                    </svg>
                                </div>
                            </a>
                            <ul class="collapse submenu list-unstyled {% if url_name in 'mobile_order_list mobile_order_detail todays_practices today_sales shops b2c_shop b2c_shop_detail b2b_shop b2b_shop_ajax'  %}show{% endif %}" 
                            id="narx-sotuvlar" data-parent="#accordionExample">
                            
                                {% if custom_user_profile.is_bugungi_sotuvlar %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'today_sales' %}active{% endif %}">
                                        <a href="{% url 'today_sales' %}">Bugungi Sotuvlar</a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_buyurtmalar %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'shops' %}active{% endif %}">
                                        <a href="{% url 'shops' %}">Buyurtmalar</a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_savdo %} 
                                <li class="menu {% if request.resolver_match.url_name == 'b2c_shop' or request.resolver_match.url_name == 'b2c_shop_detail'  %}active{% endif %}">
                                    <a href="{% url 'b2c_shop' %}">Savdo</a>
                                </li>
                                {% endif %}
                                {% if custom_user_profile.is_b2b_savdo %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'b2b_shop' or  request.resolver_match.url_name == 'b2b_shop_ajax' %}active{% endif %}">
                                        <a href="{% url 'b2b_shop' %}">B2B Savdo</a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_bugungi_amaliyotlar %} 
                                <li class="menu {% if request.resolver_match.url_name == 'todays_practices'%}active{% endif %}">
                                    <a href="{% url 'todays_practices' %}">Bugungi amaliyotlar</a>
                                </li>
                                {% endif %}
                                <li class="menu {% if request.resolver_match.url_name == 'mobile_order_list' or request.resolver_match.url_name == 'mobile_order_detail' %}active{% endif %}">
                                    <a href="{% url 'mobile_order_list' %}">Mobile buyurtmalar</a>
                                </li>
                            </ul>
                        </li>
                    {% endwith %}
                    {% with url_name=request.resolver_match.url_name %}
                        <li class="menu {% if url_name in 'reviziya revision_detail revision_complate revision_complate_items' %}active{% endif %}">
                            <a href="#narx-Inventarizatsiya" data-toggle="collapse" aria-expanded="{% if url_name in 'reviziya revision_detail revision_complate revision_complate_items'  %}true{% endif %}" class="dropdown-toggle">
                                <div style="display: flex; align-items: center;">
                                    <i class="fa-solid fa-truck-moving" style="font-size: 17px;"></i>
                                    <span style="margin-left: 10px;">Inventarizatsiya</span>
                                </div>
                                <div>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round" class="feather feather-chevron-right">
                                        <polyline points="9 18 15 12 9 6"></polyline>
                                    </svg>
                                </div>
                            </a>
                            <ul class="collapse submenu list-unstyled {% if url_name in 'reviziya revision_detail revision_complate revision_complate_items'  %}show{% endif %}" 
                            id="narx-Inventarizatsiya" data-parent="#accordionExample">
                                {% if custom_user_profile.is_reviziya %} 
                                
                                <li class="menu {% if request.resolver_match.url_name == 'reviziya' or request.resolver_match.url_name == 'revision_detail'%}active{% endif %}">
                                    <a href="{% url 'reviziya' %}">Reviziya</a>
                                </li>
                                {% endif %}
                                {% if custom_user_profile.is_reviziya_tarixi %} 
                                  
                                <li class="menu {% if request.resolver_match.url_name == 'revision_complate' or request.resolver_match.url_name == 'revision_complate_items'%}active{% endif %}">
                                    <a href="{% url 'revision_complate' %}">Tarix</a>
                                </li>
                                {% endif %}

                            </ul>
                        </li>
                    {% endwith %}
                    {% with url_name=request.resolver_match.url_name %}
                        <li class="menu {% if url_name in 'deliver debtor_account debtor externalincomeuser' %}active{% endif %}">
                            <a href="#narx-hamkorlar" data-toggle="collapse" aria-expanded="{% if url_name in 'deliver debtor_account debtor externalincomeuser'  %}true{% endif %}" class="dropdown-toggle">
                                <div style="display: flex; align-items: center;">
                                    <i class="fa-solid fa-handshake" style="font-size: 17px;"></i>
                                    <span style="margin-left: 10px;">Hamkorlar</span>
                                </div>
                                <div>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round" class="feather feather-chevron-right">
                                        <polyline points="9 18 15 12 9 6"></polyline>
                                    </svg>
                                </div>
                            </a>
                            <ul class="collapse submenu list-unstyled {% if url_name in 'deliver debtor_account debtor externalincomeuser'  %}show{% endif %}" 
                            id="narx-hamkorlar" data-parent="#accordionExample">
                                {% if custom_user_profile.is_yetkazib_beruvchilar %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'deliver' %}active{% endif %}">
                                        <a href="{% url 'deliver' %}">Yetkazib beruvchilar</a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_mijozlar_tahlili %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'debtor_account' %}active{% endif %}">
                                        <a href="{% url 'debtor_account' %}">Mijozlar tahlili</a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_mijozlar_qarzdorligi %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'debtor' %}active{% endif %}">
                                        <a href="{% url 'debtor' %}">Mijozlar qarzdorligi</a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_turli_shaxs %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'externalincomeuser' %}active{% endif %}">
                                        <a href="{% url 'externalincomeuser' %}">Turli shaxslar</a>
                                    </li>
                                {% endif %}
                            </ul>
                        </li>
                    {% endwith %}
                        
                    {% with url_name=request.resolver_match.url_name %}
                        <li class="menu {% if url_name in 'ombor omborqabul omborminus product_filial product_editing_page product tovar_prixod tovar_prixod_tarix write_off write_off_tarix recieve deliver_return deliver_return_item_detail  deliver_return_tarix' %}active{% endif %}">
                            <a href="#components" data-toggle="collapse" aria-expanded="{% if url_name in 'ombor omborqabul omborminus product_filial product_editing_page product tovar_prixod tovar_prixod_tarix write_off write_off_tarix recieve deliver_return deliver_return_item_detail  deliver_return_tarix' %}true{% endif %}" class="dropdown-toggle">
                                <div style="display: flex; align-items: center;">
                                    <i class="fa-solid fa-warehouse" style="font-size: 17px;"></i>
                                    <span style="margin-left: 10px;">Ombor</span>
                                </div>
                                <div>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round" class="feather feather-chevron-right">
                                        <polyline points="9 18 15 12 9 6"></polyline>
                                    </svg>
                                </div>
                            </a>
                            <ul class="collapse submenu list-unstyled {% if url_name in 'ombor omborqabul omborminus product_filial product_editing_page product tovar_prixod tovar_prixod_tarix write_off write_off_tarix recieve deliver_return deliver_return_item_detail  deliver_return_tarix' %}show{% endif %}"
                                id="components" data-parent="#accordionExample">
                                {% if custom_user_profile.is_ombor_boshkaruvi_ombor %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'ombor'  %}active{% endif %}">
                                        <a href="{% url 'ombor' %}"> Ombor </a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_ombor_boshkaruvi_qabul %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'omborqabul'  %}active{% endif %}">
                                        <a href="{% url 'omborqabul' %}"> Ombor Qabul </a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_ombor_boshkaruvi_ombordan_analiz %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'omborminus'  %}active{% endif %}">
                                        <a href="{% url 'omborminus' %}"> Omborda mahsulotlar analizi </a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_maxsutlo_tahlili %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'product_filial'  %}active{% endif %}">
                                        <a href="{% url 'product_filial' %}"> Maxsulot tahlili </a>
                                    </li>
                                {% endif %}
                                
                                {% if custom_user_profile.is_maxsulot_tahriri %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'product_editing_page'  %}active{% endif %}">
                                        <a href="{% url 'product_editing_page' %}"> Maxsulot tahriri </a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_maxsulot_boshkaruvi %} 
                                <li class="menu {% if request.resolver_match.url_name == 'product'  %}active{% endif %}">
                                    <a href="{% url 'product' %}"> Maxsulotlar boshqaruvi </a>
                                </li>
                                {% endif %}
                                {% if custom_user_profile.is_ot_prixod %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'tovar_prixod' %}active{% endif %}">
                                        <a href="{% url 'tovar_prixod' %}">Kirim</a>
                                    </li>
                                {% endif %}
    
                                {% if custom_user_profile.is_ot_tarix %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'tovar_prixod_tarix' %}active{% endif %}">
                                        <a href="{% url 'tovar_prixod_tarix' %}">Kirim Tarixi</a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_hisobdan_chiqish %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'write_off' %}active{% endif %}">
                                        <a href="{% url 'write_off' %}">Hisobdan chiqarish</a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_hisobdan_tarix %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'write_off_tarix' %}active{% endif %}">
                                        <a href="{% url 'write_off_tarix' %}">Tarix</a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_qabul %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'recieve' %}active{% endif %}">
                                        <a href="{% url 'recieve' %}">Qabul</a>
                                    </li>
                               {% endif %}
                               {% if custom_user_profile.is_taminotchi_qaytuv %} 
                                <li class="menu {% if request.resolver_match.url_name == 'deliver_return' %}active{% endif %}">
                                    <a href="{% url 'deliver_return' %}">Taminotchi Qaytuv</a>
                                </li>
                                {% endif %}

                                {% if custom_user_profile.is_taminotchi_qaytuv_tarix  %}
                                <li class="menu {% if request.resolver_match.url_name == 'deliver_return_tarix' %}active{% endif %}">
                                    <a href="{% url 'deliver_return_tarix' %}">Taminotchi Tarix</a>
                                </li>
                                {% endif %}
                            </ul>
                        </li>
                    {% endwith %}
                  
                    
                    {% with url_name=request.resolver_match.url_name %}
                        <li class="menu {% if url_name in 'analysis_costs kassa desktop_kassa allFilter fin_report kassa_fin data_fin debet_kredit_fin cf_fin  daily_cf_fin xarid_fin sotuv_fin pl_fin balans_fin majburiyat_fin tolov_kalendar_fin reja_tushum_fin reja_chiqim_fin asosiy_vosita_fin ombor_fin  kassa_is_approved filial_kassalar' %}active{% endif %}">
                            <a href="#filial-moliya" data-toggle="collapse" aria-expanded="{% if url_name in 'analysis_costs kassa desktop_kassa allFilter fin_report kassa_fin data_fin debet_kredit_fin cf_fin  daily_cf_fin xarid_fin sotuv_fin pl_fin balans_fin majburiyat_fin tolov_kalendar_fin reja_tushum_fin reja_chiqim_fin asosiy_vosita_fin ombor_fin  kassa_is_approved filial_kassalar' %}true{% endif %}" class="dropdown-toggle">
                                <div style="display: flex; align-items: center;">
                                    <i class="fa-solid fa-money-bill-trend-up" style="font-size: 17px;"></i>
                                    <span style="margin-left: 10px;">Moliya</span>
                                </div>
                                <div>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round" class="feather feather-chevron-right">
                                        <polyline points="9 18 15 12 9 6"></polyline>
                                    </svg>
                                </div>
                            </a>
                            <ul class="collapse submenu list-unstyled {% if url_name in 'analysis_costs kassa desktop_kassa allFilter fin_report kassa_fin data_fin debet_kredit_fin cf_fin  daily_cf_fin xarid_fin sotuv_fin pl_fin balans_fin majburiyat_fin tolov_kalendar_fin reja_tushum_fin reja_chiqim_fin asosiy_vosita_fin ombor_fin kassa_is_approved filial_kassalar' %}show{% endif %}"
                                id="filial-moliya" data-parent="#accordionExample">
                                    {% if custom_user_profile.is_kassa %} 
                                        <li class="menu {% if request.resolver_match.url_name == 'kassa' %}active{% endif %}">
                                            <a href="{% url 'kassa' %}"> Kassa </a>
                                        </li>
                                    {% endif %}
                                    {% if custom_user_profile.is_filial_kassalar %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'filial_kassalar' %}active{% endif %}">
                                        <a href="{% url 'filial_kassalar' %}"> Kassa Filial</a>
                                    </li>
                                    {% endif %}

                                    {% if custom_user_profile.is_analiz_xarajatlar %} 
                                        <li class="menu {% if request.resolver_match.url_name == 'analysis_costs' %}active{% endif %}">
                                            <a href="{% url 'analysis_costs' %}"> Analiz Harajatlar </a>
                                        </li>
                                    {% endif %}
                                    {% if custom_user_profile.is_kassa_tarixi %} 
                                        <li class="menu {% if request.resolver_match.url_name == 'desktop_kassa' %}active{% endif %}">
                                            <a href="{% url 'desktop_kassa' %}"> Kassa Tarixi </a>
                                        </li>
                                    {% endif %}
                                    {% if custom_user_profile.is_balans_hisobi %} 
                                        <li class="menu {% if request.resolver_match.url_name == 'allFilter' %}active{% endif %}">
                                            <a href="{% url 'allFilter' %}"> Balans hisobiti </a>
                                        </li>
                                    {% endif %}
                                    {% if custom_user_profile.is_fin_hisoboti %} 
                                            <li class="menu {% if url_name in 'fin_report kassa_fin data_fin debet_kredit_fin cf_fin  daily_cf_fin xarid_fin sotuv_fin pl_fin balans_fin majburiyat_fin tolov_kalendar_fin reja_tushum_fin reja_chiqim_fin asosiy_vosita_fin ombor_fin ' %}active{% endif %}">
                                                <a href="{% url 'fin_report' %}"> Fin hisobiti </a>
                                            </li>
                                    {% endif %}
                                   
                                    {% if custom_user_profile.is_kassa_tasdiklanmagan %} 

                                        <li class="menu {% if request.resolver_match.url_name == 'kassa_is_approved' %}active{% endif %}">
                                            <a href="{% url 'kassa_is_approved' %}">Kassa Tasdiklanmagan </a>
                                        </li>
                                    {% endif %}
                             </ul>
                        </li>
                    {% endwith %}

                   
                    {% with url_name=request.resolver_match.url_name %}
                        <li class="menu {% if url_name in 'one_day_price employee mobile_order call_center_payment user_detail_chiqim' %}active{% endif %}">
                            <a href="#narx-hrm" data-toggle="collapse" aria-expanded="{% if url_name in 'one_day_price employee mobile_order call_center_payment user_detail_chiqim'  %}true{% endif %}" class="dropdown-toggle">
                                <div style="display: flex; align-items: center;">
                                    <i class="fa-solid fa-user-tie" style="font-size: 17px;"></i>
                                    <span style="margin-left: 10px;">HRM</span>
                                </div>
                                <div>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round" class="feather feather-chevron-right">
                                        <polyline points="9 18 15 12 9 6"></polyline>
                                    </svg>
                                </div>
                            </a>
                            <ul class="collapse submenu list-unstyled {% if url_name in 'one_day_price employee mobile_order call_center_payment user_detail_chiqim'  %}show{% endif %}" 
                            id="narx-hrm" data-parent="#accordionExample">
                                {% if custom_user_profile.is_xodim_kunlik %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'one_day_price' or  request.resolver_match.url_name == 'user_detail_chiqim'%}active{% endif %}">
                                        <a href="{% url 'one_day_price' %}"> Kunlik Ishchi </a>
                                    </li>
                                {% endif %}
                                {% if custom_user_profile.is_xodim_oylik %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'employee' %}active{% endif %}">
                                        <a href="{% url 'employee' %}"> Oylik ishchi </a>
                                    </li>
                                {% endif %}
                                <!-- {% if custom_user_profile.is_xodim_mobile %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'mobile_order' %}active{% endif %}">
                                        <a href="{% url 'mobile_order' %}">Mobile Ishchi </a>
                                    </li>
                                {% endif %} -->
                                {% if custom_user_profile.is_xodim_call_center %} 
                                    <li class="menu {% if request.resolver_match.url_name == 'call_center_payment' %}active{% endif %}">
                                        <a href="{% url 'call_center_payment' %}">Call center </a>
                                    </li>
                                {% endif %}
                            </ul>
                        </li>
                    {% endwith %}
                    {% if custom_user_profile.is_filial_boshkaruvi %} 
                    <li class="menu {{ filial }}" style="display: none;">
                        <a href="{% url 'filial' %}" aria-expanded="{{ filial_t }}" class="dropdown-toggle">
                            <div class="">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="feather feather-map-pin">
                                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                    <circle cx="12" cy="10" r="3"></circle>
                                </svg>
                                <span>Filiallar Boshqaruvi</span>
                            </div>
                        </a>
                    </li>  
                    {% endif %}
                  
               


                    {% if custom_user_profile.is_reyting_maxsulotlar or custom_user_profile.is_reyting_yetkazib_beruvchilar or custom_user_profile.is_reyting_mijozlar %} 

                    <li class="menu {% if request.resolver_match.url_name == 'top_products' or request.resolver_match.url_name == 'top_debtors'  or request.resolver_match.url_name == 'top_delivers' %}active{% endif %}">
                        <a href="#components1" data-toggle="collapse" aria-expanded="{% if request.resolver_match.url_name == 'top_products' or request.resolver_match.url_name == 'top_debtors'  or request.resolver_match.url_name == 'top_delivers' %}true{% endif %}" class="dropdown-toggle">
                            <div style="display: flex; align-items: center;">
                                <i class="fa-solid fa-chart-simple" style="font-size: 17px;"></i>
                                <span style="margin-left: 10px;">Hisobot</span>
                            </div>
                            <div>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="feather feather-chevron-right">
                                    <polyline points="9 18 15 12 9 6"></polyline>
                                </svg>
                            </div>
                        </a>
                        
                        <ul class="collapse submenu list-unstyled {% if request.resolver_match.url_name == 'top_products' or request.resolver_match.url_name == 'top_debtors'  or request.resolver_match.url_name == 'top_delivers' %}show{% endif %}"
                            id="components1" data-parent="#accordionExample">
                            {% if custom_user_profile.is_reyting_maxsulotlar %} 
                            <li class="menu {% if request.resolver_match.url_name == 'top_products' %}active{% endif %}">
                                <a href="{% url 'top_products' %}"> Maxsulotlar </a>
                            </li>
                            {% endif %}

                            {% if custom_user_profile.is_reyting_mijozlar %} 
                                <li class="menu {% if request.resolver_match.url_name == 'top_debtors' %}active{% endif %}">
                                    <a href="{% url 'top_debtors' %}"> Mijozlar </a>
                                </li>
                            {% endif %}
                            {% if custom_user_profile.is_reyting_yetkazib_beruvchilar %} 
                                <li class="menu {% if request.resolver_match.url_name == 'top_delivers' %}active{% endif %}">
                                    <a href="{% url 'top_delivers' %}"> Yetkazib beruvchilar </a>
                                </li>
                            {% endif %}
                            
                            <!-- <li>
                                <a href="{% url 'faktura' %}"> Faktura </a>
                            </li>
                            <li>
                                <a href="{% url 'fakturatarix' %}"> Faktura Tarix</a>
                            </li>
                            <li>
                                <a href="{% url 'fakturatarix' %}"> Kunlik filial savdosi</a>
                            </li> -->
                            <!-- <li>
                                <a href="{% url 'recieve' %}"> Qabul </a>
                            </li> -->
                        </ul>
                    </li>
                    {% endif %}

                    <!-- <li class="menu ">
                        <a href="{% url 'faktura_yoqlama' %}" aria-expanded="" class="dropdown-toggle">
                            <div class="">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="feather feather-users">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="9" cy="7" r="4"></circle>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                </svg>
                                <span>Faktura yo'qlama</span>
                            </div>
                        </a>
                    </li> -->
                    <!-- <li class="menu">
                        <a href="{% url 'kurs_page' %}" aria-expanded="" class="dropdown-toggle">
                            <div class="">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="feather feather-users">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="9" cy="7" r="4"></circle>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                </svg>
                                <span>Kurs o'zgartirish</span>
                            </div>
                        </a>
                    </li> -->
                    {% if custom_user_profile.is_kassa %} 
                    <li class="menu {% if request.resolver_match.url_name == 'kassa' %}active{% endif %}" style="display: none;">
                        <a href="{% url 'kassa' %}" aria-expanded="{% if request.resolver_match.url_name == 'kassa' %}true{% endif %}" class="dropdown-toggle">
                            <div class="feather feather-layers">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="9" cy="7" r="4"></circle>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                </svg>
                                <span>Kassa</span>
                            </div>
                        </a>
                    </li>
                    {% endif %}

                    

                 

                   

                   

                   

                  
                    {% with url_name=request.resolver_match.url_name %}
                    <li class="menu {% if url_name in 'measurement_type_list money_circulation price_type product_price_type nds_page users_restrictions valyuta_list kassa_merge kassa_new_list' %}active{% endif %}">
                        <a href="#narx-turi" data-toggle="collapse" aria-expanded="{% if url_name in 'measurement_type_list money_circulation price_type product_price_type filial_list nds_page users_restrictions valyuta_list kassa_merge kassa_new_list'  %}true{% endif %}" class="dropdown-toggle">
                            <div style="display: flex; align-items: center;">
                                <i class="fa-solid fa-gear" style="font-size: 17px;"></i>
                                <span style="margin-left: 10px;">Sozlamalar</span>
                            </div>
                            <div>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="feather feather-chevron-right">
                                    <polyline points="9 18 15 12 9 6"></polyline>
                                </svg>
                            </div>
                        </a>
                        <ul class="collapse submenu list-unstyled {% if url_name in 'measurement_type_list money_circulation price_type product_price_type filial_list nds_page users_restrictions valyuta_list kassa_merge kassa_new_list'  %}show{% endif %}" 
                        id="narx-turi" data-parent="#accordionExample">
                            {% if custom_user_profile.is_measurement_type %} 

                            <li class="menu {% if request.resolver_match.url_name == 'measurement_type_list' %}active{% endif %}">
                                <a href="{% url 'measurement_type_list' %}">O'lchov turlari</a>
                            </li>
                            {% endif %}

                            {% if custom_user_profile.is_price_type %} 

                            <li class="menu {% if request.resolver_match.url_name == 'price_type' %}active{% endif %}">
                                <a href="{% url 'price_type' %}">Narx Turi</a>
                            </li>
                            {% endif %}

                            {% if custom_user_profile.is_filial_list %} 

                            <li class="menu {% if request.resolver_match.url_name == 'filial_list' %}active{% endif %}">
                                <a href="{% url 'filial_list' %}">Filial</a>
                            </li>
                            {% endif %}
                            
                            {% if custom_user_profile.is_nds %} 
                            <li class="menu {% if request.resolver_match.url_name == 'nds_page' %}active{% endif %}">
                                <a href="{% url 'nds_page' %}">NDS</a>
                            </li>
                            {% endif %}
                            {% if custom_user_profile.is_kadrlar %} 
                                <li class="menu {% if request.resolver_match.url_name == 'users_restrictions' %}active{% endif %}">
                                    <a href="{% url 'users_restrictions' %}">Foydalanuvchilar</a>
                                </li>
                            {% endif %}
                            {% if custom_user_profile.is_valyuta %} 

                            <li class="menu {% if request.resolver_match.url_name == 'valyuta_list' %}active{% endif %}">
                                <a href="{% url 'valyuta_list' %}">Valyuta</a>
                            </li>
                            {% endif %}

                            {% if custom_user_profile.is_kassa_merge %} 

                            <li class="menu {% if request.resolver_match.url_name == 'kassa_merge' %}active{% endif %}">
                                <a href="{% url 'kassa_merge' %}">Kassa Biriktirish</a>
                            </li>
                            {% endif %}

                            {% if custom_user_profile.is_kassa_new %} 

                            <li class="menu {% if request.resolver_match.url_name == 'kassa_new_list' %}active{% endif %}">
                                <a href="{% url 'kassa_new_list' %}">Kassa</a>
                            </li>
                            {% endif %}

                            {% if custom_user_profile.is_money_circulation %} 

                            <li class="menu {% if request.resolver_match.url_name == 'money_circulation' %}active{% endif %}">
                                <a href="{% url 'money_circulation' %}">Pul Muomalasi</a>
                            </li>
                            {% endif %}

                        </ul>
                    </li>
                {% endwith %}
                    
                    <li class="menu ">
                        <a href="{% url 'logout' %}" aria-expanded="false" class="dropdown-toggle">
                            <div class="">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="feather feather-log-out">
                                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                    <polyline points="16 17 21 12 16 7"></polyline>
                                    <line x1="21" y1="12" x2="9" y2="12"></line>
                                </svg>
                                <span>Chiqish</span>
                            </div>
                        </a>
                    </li>
                </ul>

        </nav>
        {% endif  %}
    </div>
    <!--  END SIDEBAR  -->
    {% block content %}

    {% endblock content %}
    <div class="footer-wrapper">
        <div class="footer-section f-section-1">
            <p class="">Built by <a target="_blank" href="http://algorithmgateway.com">Algorithm Gateway</a></p>
        </div>
    </div>
</div>
</div>




<!-- Video Tutorial Modal -->
            <div class="modal fade" id="videoTutorialModal" tabindex="-1" role="dialog">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Video Qo'llanma</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form id="videoTutorialForm">
                                <input type="hidden" id="currentUrl" value="{{ request.path }}">
                                <div class="form-group">
                                    <label for="videoUrl">Video URL (YouTube yoki boshqa xizmat):</label>
                                    <input type="url" class="form-control" id="videoUrl" required placeholder="https://www.youtube.com/embed/...">
                                </div>
                                <div class="form-group">
                                    <label for="videoTitle">Video nomi (ixtiyoriy):</label>
                                    <input type="text" class="form-control" id="videoTitle" placeholder="Video qo'llanma nomi">
                                </div>
                            </form>
                            <div id="existingVideoContainer" class="mt-3" style="display: none;">
                                <h6>Mavjud video:</h6>
                                <div class="embed-responsive embed-responsive-16by9 mb-2">
                                    <iframe class="embed-responsive-item" id="existingVideoFrame" allowfullscreen></iframe>
                                </div>
                                <p id="existingVideoTitle"></p>
                                <button class="btn btn-sm btn-danger" id="deleteVideoBtn">
                                    <i class="fas fa-trash"></i> O'chirish
                                </button>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Bekor qilish</button>
                            <button type="button" class="btn btn-primary" id="saveVideoBtn">Saqlash</button>
                        </div>
                    </div>
                </div>
            </div>


<!-- END MAIN CONTAINER -->
<!-- BEGIN GLOBAL MANDATORY SCRIPTS -->
<script src="{% static 'assets/js/libs/jquery-3.1.1.min.js' %}"></script>
<script src="{% static 'bootstrap/js/popper.min.js' %}"></script>
<script src="{% static 'bootstrap/js/bootstrap.min.js' %}"></script>
<script src="{% static 'plugins/perfect-scrollbar/perfect-scrollbar.min.js' %}"></script>
<script src="{% static 'assets/js/app.js' %}"></script>
<script>
    $(document).ready(function () {
        App.init();
    });

    
</script>
<script>
    
</script>

<script>
    let message_ele = document.getElementById("message_container");

    setTimeout(function () {
        if (message_ele) {
            message_ele.style.display = "none";

        }
    }, 3000);
    // Timeout is 1 sec, you can change it
</script>

<script>
    console.log('aaaaaaa')
document.addEventListener("DOMContentLoaded", function () {
    const table = document.querySelector("table");
    if (!table) return;
    console.log(table)
    const headers = table.querySelectorAll("thead th");
    const tfootCells = table.querySelectorAll("tfoot th");
    const calculateIndexes = [];

    // calculate_total bo'lgan ustun indekslarini topamiz
    headers.forEach((th, idx) => {
        if (th.classList.contains("calculate_total")) {
            calculateIndexes.push(idx);
        }
    });

    calculateIndexes.forEach((colIndex) => {
        let sum = 0;
        const rows = table.querySelectorAll("tbody tr");
        
        rows.forEach(row => {
            const cells = row.querySelectorAll("td");
            const cell = cells[colIndex];
            if (cell) {
                const val = parseFloat(cell.dataset.value) || 0;
                sum += val;
            }
        });

        console.log(calculateIndexes)

        // intcomma formatlash (minglik ajratgich bilan)
        const formatted = sum.toLocaleString('en-US');

        // Tfoot ustuniga natijani yozamiz
        console.log(tfootCells, 'uuuuuu')
        if (tfootCells[colIndex]) {
            console.log(tfootCells[colIndex].textContent, 'o')
            tfootCells[colIndex].textContent = formatted;
        }
    });
});
</script>

<script>
$(document).ready(function() {
    const currentUrl = window.location.pathname;
    const videoContainer = $('.video-tutorial-container');
    const videoLink = $('.video-tutorial-link');
    const editBtn = $('.video-tutorial-edit-btn');
    
    // Sahifa yuklanganda video mavjudligini tekshirish
    function checkVideoTutorial() {
        $.ajax({
            url: '/api/video-tutorial/check/',
            type: 'GET',
            data: { url: currentUrl },
            success: function(response) {
                if (response.exists) {
                    videoLink.attr('href', response.video_url);
                    videoContainer.show();
                    
                    // Superuser uchun edit modalini sozlash
                    if (response.is_superuser) {
                        $('#videoUrl').val(response.video_url);
                        $('#videoTitle').val(response.title);
                        $('#existingVideoFrame').attr('src', response.video_url);
                        $('#existingVideoTitle').text(response.title);
                        $('#existingVideoContainer').show();
                    }
                } else if (response.is_superuser) {
                    // Superuser uchun qo'shish imkoniyati
                    editBtn.show();
                    editBtn.off('click').on('click', function() {
                        $('#videoUrl, #videoTitle').val('');
                        $('#existingVideoContainer').hide();
                        $('#videoTutorialModal').modal('show');
                    });
                }
            }
        });
    }
    
    // Video saqlash
    $('#saveVideoBtn').click(function() {
        const videoData = {
            url: currentUrl,
            video_url: $('#videoUrl').val(),
            title: $('#videoTitle').val(),
            csrfmiddlewaretoken: '{{ csrf_token }}'
        };
        
        $.ajax({
            url: '/api/video-tutorial/save/',
            type: 'POST',
            data: videoData,
            success: function(response) {
                if (response.success) {
                    $('#videoTutorialModal').modal('hide');
                    checkVideoTutorial(); // Sahifani yangilash
                    alert('Video qo\'llanma muvaffaqiyatli saqlandi');
                } else {
                    alert('Xatolik: ' + response.error);
                }
            }
        });
    });
    
    // Video o'chirish
    $('#deleteVideoBtn').click(function() {
        if (confirm('Haqiqatan ham bu video qo\'llanamani o\'chirmoqchimisiz?')) {
            $.ajax({
                url: '/api/video-tutorial/delete/',
                type: 'POST',
                data: {
                    url: currentUrl,
                    csrfmiddlewaretoken: '{{ csrf_token }}'
                },
                success: function(response) {
                    if (response.success) {
                        $('#videoTutorialModal').modal('hide');
                        videoContainer.hide();
                        alert('Video qo\'llanma muvaffaqiyatli o\'chirildi');
                    } else {
                        alert('Xatolik: ' + response.error);
                    }
                }
            });
        }
    });
    
    // Dastlabki tekshiruv
    checkVideoTutorial();
});
</script>

<script src="{% static 'assets/js/custom.js' %}"></script>
<!-- END GLOBAL MANDATORY SCRIPTS -->
{% block js %}

{% endblock %}
</body>
</html>
